from __future__ import division
import tensorflow as tf
import math

init_tensor = tf.constant([100, 102, 203, 250, 360, 300, 66, 100, 330, 220, 33, 66, 67, 8, 9, 2])
init_tensor = tf.constant([997666850, -1158227499, 984676224, -1159120728, -1160296934, -1138865026, -1159514222, 1001111305, -1180208017, 999423769, -1162334203, 1016787012, 1001523608, 1011954445, 1006523604, 1003716012, -1197068392, 993973272, 985186603, -1169375941, -1162306417, 1001564874, -1148435996, -1131750828, 999634928, 983432242, -1164870450, -1157945669, 989375587, -1134210232, 998492058, -1156031316, -1160672845, -1146088186, -1169011804, -1139733616, -1140787943, 1002702747, 1001414612, -1148422280, 990550212, 957856069, 959065892, -1153342022, 992522507, 996456833, 1007007073, -1155666012, -1173878957, -1162267410, -1147548259, 986197010, -1139678004, -1157128593, 1000614185, -1186266774, -1176116621, 982700723, 987817280, -1197060257, 1002319630, 1018524145, 998994607, -1172699592, -1165136282, 997306986, 1007099669, 972859577, 959326481, 997104769, -1138057639, -1137616557, 995392281, 987647680, -1148228438, -1158565438, 991750559, -1138558165, 1003955782, -1156672198, -1162054820, -1164399949, 1002351080, 980200424, 974908058, 1009805999, -1151195627, -1136766856, -1145259550, -1204259246, -1171572693, -1216563921, 997400056, -1141713425, 1002322873, 992129834, 995157714, -1167600259, -1159220464, 964077474, -1166749175, -1146707252, -1189571474, 987897199, -1209629049, 997602334, -1155091081, -1151855086, 1008745144, 1017063551, 1003130254, 940347514, 943857012, -1159275927, -1151658950, 984354141, -1143240230, -1143704204, 991413677, 989962179, 974524659, -1162602760, 998274695, 1010842565, 995639100, 1020945819, 997366724, 1000520985, -1153235240, 992812430, 990035408, -1143896373, -1155080069, 990915698, 990707832, -1134627354, -1162575889, 992725960, -1149191819, -1155583539, 975204064, -1144966812, 994196960, -1145908202, -1181931663, 998671825, 1003943446, 961300433, -1193916395, 1000549866, -1141828370, -1134239339, 997159422, 985026267, -1151530536, -1156096614, 991247765, -1138678728, 1002474582, -1155436120, -1164524623, -1152354807, -1150986669, -1152590283, -1147485716, -1170577763, 999842827, -1135929399, -1148128374, -1150805183, -1155595153, -1133789430, 987421589, -1141963300, -1161683594, -1149101015, 972636801, -1165811830, -1152098368, -1159927217, -1148061024, 981396836, -1189599617, 998869165, 983513862, 984633071, 974078007, 1009340681, 994438283, 1020572490, 996129695, 995248877, 981744869, 985429311, -1157111710, -1163507335, -1159031636, -1173798241, -1166074300, -1175855956, 933082704, 991338732, 957040453, 997625704, 999261993, 1021670927, -1190453248, 977278114, 973205667, 985217354, 976335377, 979344335, -1160613742, 1001803924, -1142161074, -1132363615, 1000155469, 988396469, -1162627821, 1000752885, 993536781, -1142537551, 1005832390, 982657735, 964314668, -1154983412, -1151379044, -1178889118, -1145920564, -1139781954, 999272909, -1172389832, -1174497849, -1152116466, 998803033, -1135686522, 1002063079, 1016783599, 988167055, -1156267300, 977745249, 998297539, 990484484, -1164864115, -1174402765, 1001605614, -1146626315, -1131876583, 999242995, -1206833587, 966328114, -1165827431, 989944160, -1135996760, 998678991, -1150980334, -1163650624, -1164193003, 973090085, -1170360316, 982894496, -1145251837, -1154333607, 995905913, 968894642, 999228763, 985145007, 1013816111, 994720478, 1015733164, 1002176764, 1006949354, -1178198462, 1000965775, -1161473094, 987341878, -1195108220, 1003226722, -1146641231, -1131613332, 1007046174, 974177316, -1177679008, -1156956492, 990128451, -1139190283, 996736546, -1156704543, -1167710090, -1145647165, -1147083625, -1142465585, -1138792491, 1009398413, 972805165, -1143547609, 981795709, 975721670, 983953924, -1151815372, 981570236, 976170929, 1008093403, -1173939506, 987854866, -1163539828, -1151631689, 985376260, -1147911790, -1165019179, 1003200673, -1158729630, -1176676995, -1183707256, 949894793, 981899109, 1008688663, 1017405411, 994946238, -1163815130, 972033455, 996051896, 995583237, 993877252, 982422644, 996995261, -1141965743, -1138814479, 1007729801, -1182747450, 976244743, -1154686430, 991481033, -1136311595, 1002891313, -1164353246, 991404891, 935979853, -1180050990, 995349387, -1199744189, 987321008, -1156617243, -1152605337, 1000449103, -1146738074, 998551047, -1165430102, 971415703, -1149143603, 1003431346, -1157364504, 984698490, -1152732269, -1157554535, 988839898, -1193440990, -1167002008, 1001668846, -1156696515, 981929812, 1000097331, -1157382195, -1143407298, 1005329060, 1019155355, 999757549, 977365176, -1167546399, -1168158189, -1156551318, 987770340, -1150371495, -1150075218, 997632884, 995669580, -1173307119, -1154987831, 983190660, 1013657063, 1005690853, 1020598307, 997654526, 993104603, 957708299, 995300741, -1175812187, -1149190902, -1152737025, 996100559, -1171915744, -1137933236, 998010594, 987356499, -1152715325, -1162462116, 994238120, -1149061709, 1004191859, -1160095731, -1178697089, 1000097231, 993729038, 993614066, 975401241, 1000316050, -1144086445, -1135810693, 1007311994, 978825444, 947914333, -1149551896, 992380422, -1137135154, 1001526864, -1164774798, -1148778643, 966558668, -1150510017, -1151583122, -1146132845, 979477255, 1009355494, -1143997792, -1147683733, -1161088088, 983529189, -1129437082, -1196385360, 993285662, 990096300, -1152658354, -1163910667, 992994612, -1150704892, -1158878129, -1155106369, 966098593, -1171755112, 981501330, 982930433, 978087559, -1162924066, 1007924307, 1001514899, 1019594811, 997900495, 997275036, 992109769, 992688366, -1150992908, 965179841, -1173535442, -1170302103, 990138282, -1165709760, 974427300, 992296366, -1181891730, -1166090177, 1000978727, 1021965676, 992110855, 981886149, 961210622, 996322598, -1150062628, 981759363, 975453006, 996209393, -1141607293, -1131700126, 1006730446, -1189241019, -1172466628, -1159447057, 992618555, -1152769518, 1003241231, -1179300231, -1171963919, -1154087350, -1152075756, 965911361, -1148132019, -1143975897, 1003006300, 978903782, 953067103, -1155746171, 996050058, -1131942490, 1001391914, 1017534997, 998170780, -1155944569, 967792317, 1002681267, 965906378, 992235878, 972943432, 1002707720, -1145586242, -1132861942, 1007858047, 973580214, 974520633, -1147945949, 991394172, -1142378343, 998621206, -1183280343, -1169025107, 993534217, -1201506277, 968463117, 985562892, -1149239377, -1140325190, 1007748166, 1004136953, 993489430, 980883915, 1009943399, 1000786328, 1016966696, 1008433788, 1003147786, 960494050, 1002467735, -1173350725, 993840735, -1169853521, 1006124954, -1148735126, -1131006316, 1003033658, 990160760, -1154548457, -1161486913, 991507204, -1141914719, 999309370, -1181989289, 992059885, -1149490310, -1148561999, -1143494855, -1139319588, 1008174947, 998916500, -1143063612, -1161201070, 987911105, -1164299430, 924713364, 990235988, 989245204, 1010058526, 973156112, -1199208127, 988544844, -1152979692, 974550021, -1152386429, -1163946371, 998146129, -1145357773, 952559691, -1190056272, 991699390, -1139000079, 1004943082, 1017092076, 982916039, -1185500028, -1160636203, 991933293, 985152494, 1001535683, 1001322117, 999977790, -1149940863, -1132195974, 1008316651, 992705459, -1164763518, -1149820823, 989606844, -1137816455, 1003269599, -1157239531, -1170149124, 959671861, -1164170312, 1006398920, 1007098610, 1001146678, -1146770729, -1134696645, 1003417975, 993019516, 953336168, -1141531737, 997658728, -1169615523, 1004257058, -1163521098, 970858668, 983180196, -1164664218, 995117836, 984612832, -1147115851, 1001245000, 993604961, 994747699, 1000994526, -1165592353, -1146341811, 1007565158, 1022261580, 1004380726, 975023283, -1191408492, -1172472566, -1157030424, -1165352987, -1152948078, -1147552476, -1223551506, 992537690, -1170519988, -1165991783, 987571660, 1003604574, 999039729, 1021742296, 998566614, 998546243, 970102993, 987173371, -1146533454, -1159452517, 944813610, 995325125, -1146684730, -1136320698, 1007904504, -1162108853, -1165807271, -1154702530, 988235802, -1143277739, 1003711843, -1164083072, -1170105067, 997096387, 984852618, 999143582, 994349712, 1001119160, -1151657210, -1130897803, 1005589833, 985765134, -1161942217, -1153163061, 988379836, -1136489113, 1001957008, -1173947991, -1156240645, -1195058708, -1155781686, -1161358349, -1157605997, -1145196649, 1001958862, 980885552, 924900504, -1152426093, 998341777, -1130253166, -1167912831, 1003126543, 998044747, -1150623815, 988383566, 990430550, -1148203654, -1172978436, -1157403310, -1161201974, -1154001960, -1186295316, 997513281, 998316148, -1174907090, 999284713, 1002784875, 1018507411, 997809192, 995667848, 981169634, 988417459, -1148915991, 986000711, 977042306, 975157452, 977993071, 991362333, 999636462, 996574656, -1172565931, -1158572586, 1000434818, 1022029557, 997731941, 979842120, 982084580, 1000394395, -1156727772, 981141652, 992010773, 984738875, -1139179908, -1134873632, 1002243628, -1165651934, -1164661290, 934591240, 990551817, -1155166894, 1002536564, 992794077, -1173567930, -1153584105, -1157126292, 971558732, -1152377576, -1144486368, 998602155, 971189921, 986232564, -1154666988, 1000122668, -1131849448, 1002448636, 1017420843, 999520411, -1162709181, 983800711, 1003415150, -1182539693, 991043834, -1164551338, 1002412407, -1139830991, -1132449646, 1002338022, 978073757, -1152210307, -1153648176, 988073957, -1138976045, 999467432, 976157368, 990031099, -1159995252, 979286661, -1149061107, -1159427091, -1142896227, -1144354304, 988106366, -1159033223, 999456467, 965760150, 1009291769, 989683321, 1015179494, 1004908305, 1004786373, -1180786915, 956781322, 981822966, -1161339474, -1159145217, 1005904888, -1156117222, -1134474581, 999237148, 990261768, 979459008, -1155990380, 991240885, -1134249116, 999592264, -1155651158, 941723452, -1164702360, -1162465538, -1140464377, -1136606742, 1001500180, 984607004, -1146525456, 998490015, 985366248, -1152771252, -1162321469, 993612699, -1140579638, 1001473782, -1152560314, 959525899, 957612131, -1145915636, 991388382, -1145699334, -1151452891, 995598490, -1156607402, 971885065, 978367938, 982941164, -1158687251, 1006438336, 1019515353, 991460412, -1170303804, -1164419771, -1166955065, 1004937896, -1195545860, 985345016, 999369850, -1142185400, -1144522555, 1001078449, 992545611, -1150187330, 991292518, 999568772, -1142185786, 1009421650, -1161504460, -1152874483, -1146881814, 1007490590, 988801926, 965621656, 1006596054, -1153340728, -1145038905, -1148783144, 997393283, -1155353004, -1149247433, 999942282, 986223657, 1002993428, 967298572, 980128480, -1155097727, -1156792496, -1157384345, 990530428, -1145796165, 994314620, -1165011040, -1161099647, 1004104030, -1165161705, -1141146766, 1007894579, 1019082852, 999796913, 986484554, 991524664, -1155359890, -1147942684, 973457036, -1142217983, -1142101311, 991344427, -1164081985, 977466725, -1170205182, 982936519, 1010384959, 991200309, 1019456480, 999903454, 997112752, -1148264066, 984575920, 975253101, -1142896474, -1150293653, 977924609, 981544039, -1137805206, -1161687584, 980367886, -1148639935, -1162760822, 980838394, -1142991219, 994427171, -1147419579, -1196943428, -1190048044, 1002890255, -1168654071, 980424390, 1004330775, -1142761674, -1139321078, 1001386863, 994763533, -1160445095, 983816076, 998162643, -1139690862, 1007960576, -1155438995, -1150148531, -1157998405, -1185198075, -1153975412, -1148390775, -1142377888, -1187375466, -1148142034, -1159992270, -1148894811, -1160629575, -1135169088, 971573278, -1166466742, -1143086165, -1148443586, 986693630, -1159686114, -1152665611, 974706666, -1156247393, -1135198443, 975812745, -1150126697, -1176649336, 992135843, 991937847, 1004743208, 998969499, 1020958587, 1007036150, 998577445, 987683013, 984190429, -1153204266, -1204180227, -1171091412, -1135475087, -1195867050, -1153752376, -1172754367, 953160193, 996021260, 980202823, 996266208, 1022648865, 968317532, 988081403, -1157337028, 994357955, 996713059, -1170163390, -1146556391, 1000653467, -1148592321, -1133298682, 992052895, 996092295, -1183609994, 985654799, 987283588, -1144013422, 1004163684, -1153380872, 974730841, -1162780894, -1153970341, -1158108105, -1163965248, -1145111293, 986856093, -1145063324, 970585269, -1152969688, 999298279, -1137544747, 1002026563, 1018795539, 998848432, -1160372895, 955253116, -1179860891, 988780534, -1159095406, -1177728547, 1004435606, -1147496336, -1138553759, 996330506, 986646120, -1186695766, -1165246311, 991050330, -1133675275, 1000132000, -1154846087, 988767381, 985596747, -1157039215, -1155983982, 986691937, -1144991723, -1151134981, 1000009543, -1172369537, 989822323, 998125854, 1009720283, 993534532, 1017627551, 1006702274, 1003003337, -1183105743, 990024652, -1156307518, 982636189, -1166634177, 1007400013, -1148698247, -1136147830, 1000169437, 980090447, 977230999, -1155068551, 986555183, -1134995291, 993682605, -1155641055, -1170713572, -1156909861, -1155029223, -1148557211, -1139158614, 1005348743, 1002594216, -1139250033, 991873452, 993122852, -1154119551, -1158573613, 991977086, -1142929145, 997190711, -1150739085, 989935682, 985481651, -1147927557, 973324752, -1151971913, -1145759331, 982418238, -1144573818, 974784252, 982790208, 996688515, -1152568895, 1007485771, 1020197567, 990710734, -1181444180, 981370041, 984904887, 988206769, 984200245, 968359027, 1006954576, -1140118926, -1140475068, 1007177111, 987876476, 997684449, -1159356696, 995208111, -1136292641, 1002959142, -1157105782, 971724267, -1148991665, 987762920, 985590555, -1166853251, 1006780178, -1158888904, -1147926189, 988906167, -1156502454, 993404101, -1152514957, 985018152, -1149297585, 1007127940, -1185528340, 985385812, -1154462782, -1152385481, 941319408, 983142508, -1155216015, 1003890711, 984807454, -1164003340, 990125258, 957161353, -1140897422, 1005592548, 1020133182, 1004777032, 985382109, 984813559, -1174354123, -1153228511, -1186288455, -1150691441, -1147324537, 991428391, 982221776, 975797640, 987538191, 982189881, 1009632428, 1002044185, 1020610114, 998086868, 997178984, 973142322, 965221277, -1168704609, -1148195915, -1142238311, 992721854, 999001501, -1138991360, 989603591, 992512712, -1156997940, -1191553122, 993511844, -1140254017, 1007305786, -1157949360, 969520996, 980341896, 982122782, 983666372, -1198856968, 1007840345, -1140604057, -1137102871, 1003524192, 988015191, 993755773, -1156745659, 993726527, -1135995949, 1000805571, -1159215528, -1145603739, -1154827297, -1175973256, -1149212921, -1144752347, -1143812065, 1009310043, 990530055, 977294407, -1147549304, -1156183089, -1131387438, 988028978, 1003882721, 998736674, -1148398208, 977049187, 972261341, -1155300223, 974257626, -1196141956, -1137830896, -1164144301, -1152842465, -1184082032, -1166238729, 995934817, 1003482791, 998089636, 1021535365, 1002046553, 998623584, 970169679, 993706096, -1161132453, 980571344, 976613684, -1138042269, 995986578, 985934059, 978270580, 993072738, 985455992, -1154267867, 1002140426, 1023020696, 1001642572, 986151062, -1216283041, 996339989, 976418671, 963591075, -1166161517, 998350420, -1152428581, -1132460687, 1001139810, 994967203, 965872828, -1174552420, 985989056, -1147235903, 1003893619, -1161525168, 977760272, -1163660280, -1151099363, -1171715159, -1161240818, -1142334742, 990772831, -1146229421, 991150044, -1143373899, 1000084189, -1133541562, 998676490, 1016801264, 1003603955, -1159203132, 973465884, 999733953, -1174160394, 990456467, -1170130964, 1003889990, -1147642169, -1135766875, 1002435464, 976226378, 992632485, -1166855145, 990658224, -1135565028, 999182315, -1157743537, 979930420, 989830168, -1164101850, -1164434068, 1001392649, -1160714885, -1149854689, 1008228469, 1004883252, 993659357, 980524953, 1008635567, 998658536, 1016252913, 1010208210, 1000006651, 977935851, 997952392, -1169417381, 988940275, -1159314127, 1006555513, -1150788104, -1135911799, 999905593, 988358606, -1156591912, -1170159094, 988388249, -1138242991, 1000572304, -1160999320, 982323839, 976007451, 975408219, -1154234564, -1140041260, 1004945161, 1000813567, -1145838296, 991110049, 995926671, -1147195214, 971709558, 990519578, -1142133328, 1000838484, -1149678073, -1195453933, 994760358, -1152426749, 977348528, -1165238122, -1142678921, -1181059875, -1140313674, 972906382, -1169840293, 1004243644, -1136475737, 1002081970, 1017568609, 954509769, -1177830988, -1167794881, 981996118, -1166052148, 998535572, 997543306, 1006011477, -1139380867, -1136812482, 1003389612, 995798015, 990653976, -1156936795, 991593043, -1139207113, 1001601470, -1156523507, -1146800416, -1152615701, -1159465978, 1004503308, 1001048015, 1003884940, -1141772216, -1128888913, 998459589, 1000146791, 997232268, 989868292, 984994085, -1162267670, 1010676605, 969135988, 984288262, -1162903506, -1162284491, 974684914, 999917948, -1145969249, 999543721, 1004778347, 995447065, 993548984, 984834710, -1157612966, 1007043091, 1023479852, 1009110050, 979765309, 973605055, 982291466, -1152843321, -1161405026, -1161179558, -1142108760, -1158385927, -1182283538, 990590337, -1157244748, 997831341, 999200021, 997828427, 1020937649, 1004491759, 999475395, 959155305, 982187952, -1151392353, -1170771541, -1156012409, 1005658237, -1189647719, -1130831403, 1005088690, 987618902, 979967205, -1153841019, 988200294, -1140941884, 1001902713, -1162247002, -1173692289, 983675815, -1169162904, 990029664, 985004581, 1005809381, -1141089470, -1137281481, 999347985, 993015263, -1182733625, -1154840777, 991450233, -1136871119, 1002373185, -1156470262, -1152627188, -1140566155, -1157372915, -1157556772, -1170581796, -1137842161, 1000621908, -1174425332, 1005221897, -1151931466, 982238252, -1131896014, 979906122, 1000993108, 1006299976, -1148373334, 971014921, 994461482, -1159820173, -1169312972, -1169886351, -1134163769, -1165362970, -1158761369, 991881288, 992994944, 1000670558, 973858113, 999192718, 1022050033, 1003493088, 1000083583, 971934206, 987222674, -1152520284, 984975362, 982502969, -1139567959, 992529630, 984066506, 997363056, 1001277815, 974385104, -1150697337, 998571266, 1023659652, 1002882432, 987288847, 976728704, 1004194936, 979640692, 949696064, -1160373426, -1180532929, -1148531865, -1131651908, 999904657, 984188702, -1156437832, 999421807, 985868453, -1147170560, 1009939770, -1194706250, 954727212, -1154213031, -1150178751, 975012992, -1158472441, -1143148527, 985470003, -1165446951, 986666042, -1149490538, 999825859, -1133268381, 1001455511, 1018464751, 999598869, -1172089977, 985195125, 999622678, 981052578, 992654456, -1173356606, 1007086618, -1147227083, -1134288258, 1002735604, 993613934, -1165645176, -1155144761, 992261298, -1139354433, 1001669234, -1173846741, -1168202749, -1163110025, 986564345, -1156903707, 991495013, -1139952552, -1140441630, 982343930, -1170885746, -1153248067, 991698400, 1009966789, 984481640, 1017299762, 1007955452, 1001395998, 970861654, -1165496476, -1183117416, -1152042963, -1151216924, 1009192754, 968478838, -1135632887, 999440099, 985914777, 975121279, -1158778768, 978040539, -1138920060, 1003871685, -1152617459, 982147565, -1163978890, -1156561630, -1208348407, -1139187583, 1006852580, 1005404306, -1141841110, 997251844, 984550319, -1146971337, -1153064890, 988345661, -1139565037, 1005087883, -1154192929, 961802469, -1182738707, -1145110501, 977979602, -1146725729, -1142626630, 993188819, -1147145113, 975814720, -1156500554, 993629968, -1149074865, 1004307864, 1018687734, 997178952, 965131999, -1163889111, -1166577515, 1002601159, -1152172078, -1148121658, 1001574045, -1149212649, -1140232181, 999097761, 991235192, -1150388169, 994929437, 985974718, -1146754990, 1012259628, -1153531321, -1153681038, -1160995959, 1004211165, 981728276, 986538720, 961662289, -1164191519, -1192765153, 985755642, 1001752366, -1143120140, 985171253, 1003810132, -1143727734, 1003369433, -1187833080, -1160093637, -1167372270, -1172150046, -1167586473, 993605875, -1149200889, 994502825, 988517256, -1170590848, -1172608328, -1187949827, -1148319180, 1004274243, 1022698785, 989520611, -1169252759, 995923942, -1153509825, -1151978330, 990348846, -1148851027, -1147977001, 999083065, -1155346575, -1165509325, -1154035143, 908027544, 1007058806, 993276490, 1020137523, 999566308, 994557734, -1166060540, 994439022, 982816260, -1144056534, -1145048548, 985243577, 996982497, -1139764522, 987631221, -1170946287, -1143114369, 986556878, 994777603, -1145177981, 988156042, -1152270491, -1200747801, -1171826660, 1000157908, -1149597575, -1148355859, 1006255156, -1148809528, -1139006138, 1000148024, 992587537, -1163684148, 990753635, 977444300, -1143681061, 1010456201, -1151359778, -1148351956, -1146165896, 986061864, -1148229982, -1155661594, -1149090344, -1139995395, 998598629, -1187271753, -1138978539, -1147303763, -1139630990, -1163170200, -1151288847, -1165214566, -1150399855, 995204365, -1154049192, -1150231587, -1153115941, -1156276446, -1138098477, -1154786696, -1146819346, -1178449359, 984567741, 1000622870, 983512623, 993540393, 1019956097, 1007900728, 998994939, 985671178, -1172613093, -1155242666, -1165434137, 954925914, -1137658714, -1164695358, -1165889044, -1188871058, 978223812, 1001932470, -1165243136, 1001908319, 1023040275, 992827411, 988849038, -1173652766, 990683768, 995296418, 961210139, -1163529397, 997004788, -1148383101, -1138377977, 1001096588, 1000963072, 986049472, 999424847, 992240714, -1139701019, 999531148, -1150383281, -1174334450, 977090571, -1153990777, -1168857685, 973574678, -1140099286, -1156237309, -1154248272, 990420070, -1146476131, 996504929, -1146684531, 1003500982, 1015644906, 997789972, -1156294300, -1181172626, -1162451493, 983710211, -1150661188, -1145214961, 1007838276, -1152803267, -1139410395, 999626395, 989636915, -1168104573, -1162778409, 969431448, -1138520590, 1003901383, -1152946015, 988944502, 979129753, -1162158452, -1185797008, 999693251, -1141901234, -1164087673, 1005908389, 962446629, 970872083, 982882294, 1009840157, 999562972, 1018897799, 1010370588, 996594610, 966797427, 986470481, -1152500513, -1173247872, -1155690142, 1010137309, 961770606, -1137908319, 999095325, 983256716, -1163085357, -1151233503, 977419374, -1136304655, 1000846300, -1153873370, -1163723367, -1173824030, -1150973910, 978508900, -1143877743, 1009578077, 1001073742, -1146428847, 996904243, 998451223, -1149296670, -1152565262, 994717960, -1141247902, 1005866543, -1148002822, 990389109, 972992699, -1148393825, -1168805799, -1155227962, -1138286738, -1152289808, -1141601055, 985577934, -1187181575, 1000969366, -1147178123, 1001387987, 1017998981, 989087292, -1190383004, 988711128, -1173463617, 987196521, -1163140789, -1149018728, 1009734754, -1149276170, -1139799815, 1003708114, 995427091, 999002373, -1178577272, -1174141112, -1145185590, 1008198572, -1151593902, 986936542, -1146413678, -1163152774, 965011109, -1156941347, 1007554190, -1148262528, 1005343428, -1182011791, 987470620, 986277768, -1152532106, 1002263604, -1137448802, 1002118388, 989551697, 988547127, -1186738402, -1159343569, 977469842, 984591126, -1150694515, 1006785891, 1008033781, 991376123, 1001839289, -1164959729, -1148811816, 1008507726, 1023586407, 1005176111, 987845418, 995814955, -1165496601, -1151872694, -1188546964, -1156808631, -1146605429, 975908418, -1150725267, 954856053, -1163007274, 995852739, 1005880273, 998519226, 1022878000, 999556873, 994167153, 959461192, 982546351, -1199492694, -1146549766, -1140353772, 999798998, 995066101, -1137020778, 1000489488, 992162002, -1170259551, 983241132, 988795707, -1136266145, 1001567097, -1154723948, 982941313, 975682201, 981125030, -1157007417, -1149234868, 1009795164, -1156189514, -1137557733, 1000914455, 990869306, 994088354, -1158020704, 974245693, -1140739382, 1005956054, -1148846451, -1155205159, -1144548520, 984837058, -1146916596, -1148799826, -1149480407, -1164349849, 1008261648, 995573828, -1138231660, -1146463180, -1132320773, 987690763, -1177380094, 1008994899, -1157773979, 993484518, -1156099731, -1154521554, -1153554521, -1158458161, -1136470401, -1176219459, -1154366256, -1177161578, -1154332982, 1001044245, 996397282, 993800040, 1020553642, 1009165951, 992643956, 991670122, 973336631, -1164630283, -1196114737, 988843458, -1139348836, 997143613, 966713007, 985765994, -1178879784, 990067608, -1153694876, 1002179674, 1023378351, 1008076443, 998084846, -1161669716, 992995863, -1174835723, -1173206126, -1158818970, 1000325233, -1142105201, -1142593853, 990738808, 995469003, -1186830444, -1165574478, 997827019, -1134886766, 993334634, -1165517546, -1188739344, 978609738, -1153983582, -1174735305, -1172932072, -1143233072, -1160578092, -1153505873, 989636970, -1149157185, 989557890, -1137204364, 1004767115, 1015203810, 993271299, -1183238902, -1177753727, 977074345, -1154791317, -1164578902, -1150188993, 1007890379, -1153731053, -1139080089, 997659971, 979596781, 951202500, -1155215775, -1185680700, -1133730747, 999153747, -1148810856, 987863931, 992778708, -1161972867, 988276897, 1003037119, -1149649191, -1148092716, 1005378630, 1000113616, 990014692, 976349248, 1011944166, 994658226, 1017586842, 1009721048, 1000219145, 981506147, 990629045, -1163546721, 985948897, -1153180465, 1007037809, 972437288, -1135709414, 998870764, 977812619, -1152802999, -1156490519, -1196166848, -1136607334, 1001117701, -1153587460, -1161033910, -1171271006, -1157614356, 978631159, -1143844805, 1008453611, 988000270, -1141416680, 991685871, 998949242, -1150599913, -1148269201, 975995256, -1136753022, 1001055178, -1148196294, -1178328693, 984623658, -1157231562, -1181685482, 966107532, -1139713589, -1178716076, -1152530164, 989233466, -1153780246, 1002839163, -1139100638, 1006020922, 1017328966, 982447856, -1167183420, 950151763, 993569855, 955805122, 984776772, 958391392, 1008659408, -1152022381, -1140350401, 1000574105, 999988350, 975141000, -1163490321, -1181087315, -1139202138, 1004155185, -1153579043, -1150027822, -1163478111, -1170046850, 1000067348, 998632527, 1000533436, -1144693430, -1140503951, -1173941386, 997395776, 989367767, 992981283, 992313458, -1135710390, 1000515933, -1149835038, 991653406, -1154285027, -1155549292, 991451144, 997681391, -1151731902, 1004006672, 1005163239, 999264371, 999275722, -1153076785, -1156332874, 1006839928, 1023556300, 1007934840, 986104023, 960719081, 974451783, -1155032578, -1195123224, 987362269, -1145624677, 974035022, -1156515969, 993939674, -1154799108, 999917901, 1000297267, 1002849678, 1022435640, 1002254636, 998515659, -1158579319, -1176551523, -1146887990, -1155672509, -1156546524, 1008988584, 995107238, -1137808398, 1000859325, 999337940, 989412396, -1157271591, 987812352, -1139361276, 995395202, -1152287356, 972398992, 992040073, 971598451, 969358416, -1175471347, 1008006946, -1166004030, -1139013928, 1000177880, 995760300, -1168193114, -1156198601, 926385882, -1139435903, 1004812949, -1154036069, -1156072333, -1135432570, -1153824150, -1155990572, 973646167, -1150439559, -1152465337, 999570343, 1002059844, -1144825647, -1153289175, -1130646594, 982691309, -1188107254, 1011107550, -1164555969, 981060952, -1165469864, -1157733013, -1162516385, 985781888, -1137070701, -1160109785, 981575287, 987791867, -1162477762, 1003533773, 999082847, 999479628, 1020850975, 1007219471, 1001126492, 973403289, -1169951581, -1156686712, 952848709, 991444531, -1139430457, 992594876, 998902266, 992285805, 997501280, -1182142986, -1153879273, 998096467, 1022981518, 1008316150, 993512760, -1181635775, 998417359, 984282950, -1207440610, -1206177917, 970680007, -1147183309, -1143126333, 1001909685, 988363816, -1148725265, 991154226, 987407296, -1132243328, 1006562541, -1149416328, -1163471477, 929189930, -1152768757, -1168655189, -1166385435, -1142124832, -1158180564, -1156065288, 991893702, -1156713388, -1189344284, -1136236805, 1003005673, 1017814050, 993319634, -1180655996, 968472009, 994870487, 948540304, 989184389, -1162849623, 1004691036, 977019414, -1135252539, 1000899050, 994008317, -1156959324, -1156823332, 967355059, -1138738346, 1003274026, -1153521572])
# N=16
# k=10

N = 2304
k=23

log_init_tensor = tf.bitcast(init_tensor, tf.int32)


_, indices = tf.math.top_k(tf.math.abs(init_tensor), k, sorted=False)
indices = tf.sort(indices, axis=0, direction='ASCENDING')
values = tf.gather(init_tensor, indices)
with tf.Session() as sess:
	print("Values Int: ", sess.run(values))
values = tf.bitcast(values, tf.int32)

bloom_compressor = tf.load_op_library('./bloom_filter_compression.so').bloom_compressor
bloom_decompressor = tf.load_op_library('./bloom_filter_compression.so').bloom_decompressor

# bloom size is given in bytes, so for a bloom of 8 bits set bloom_size to 1
# bloom_size = 1

fpr=0.01

bloom_size = (k * abs(math.log(fpr))) / (math.pow(math.log(2), 2))
quot = int(bloom_size / 8)
rem = bloom_size % 8
bloom_size = quot
if rem != 0:
	bloom_size += 1

h = (bloom_size * 8 / k) * math.log(2)
hash_num = int(math.ceil(h))

bloom_size=2
hash_num=2
print("BLOOM:", bloom_size)
print("HASHNUM:", hash_num)
second_bloom_size = 1
second_hash_num = 1
print("BLOOM 2:", second_hash_num)
print("HASHNUM 2:", second_bloom_size)

policy = "conflict_sets"
stacked = True

mem_mode=0
step=tf.placeholder(tf.int64, name='step')
compressed_tensor = bloom_compressor(values, indices, log_init_tensor, step,
									 stacked=stacked,
									 false_positives_aware=True,
									 policy=policy,
									 hash_num=hash_num,
									 bloom_size=bloom_size,
									 second_hash_num=second_hash_num,
									 second_bloom_size=second_bloom_size,
									 logfile_suffix=1,
									 logs_path_suffix=1,
									 verbosity=1)

decompressed_tensor = bloom_decompressor(compressed_tensor, N, step,
										stacked=stacked,
										 policy=policy,
										 mem_mode=mem_mode,
										 hash_num=hash_num,
										 bloom_size=bloom_size,
										 second_hash_num=second_hash_num,
										 second_bloom_size=second_bloom_size,
										 logfile_suffix=1,
										 logs_path_suffix=1,
										 suffix=1,
										 verbosity=1)

with tf.Session() as sess:
	print("Initial Tensor: ", sess.run(init_tensor))
	print("Values: ", sess.run(values))
	print("Indices: ", sess.run(indices))

	# sess.run(compressed_tensor, feed_dict={step:0})
	# print("Compressed Tensor Shape: ", compressed_tensor.get_shape())
	sess.run(decompressed_tensor, feed_dict={step:6})
